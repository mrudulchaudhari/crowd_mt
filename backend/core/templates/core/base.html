<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{% block title %}CrowdMgmt Test UI{% endblock %}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  {% load static %}

  <style>
    :root{
      --bg: #f5fbfc;
      --card: #e9fbff;
      --muted: #64748b;
      --text: #0f172a;
      --accent: #0ea5a4;       /* teal */
      --accent-600: #08928b;
      --primary: #2563eb;      /* blue for actions */
      --danger: #ef4444;
      --ok: #10b981;
      --warn: #f59e0b;
      --glass: rgba(255,255,255,0.7);
      --radius: 14px;
      --container-w: 1100px;
      font-family: "Inter", "Segoe UI", Roboto, sans-serif;
    }

    /* Reset */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body,#app{height:100%}
    body{
      background: var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      font-size:15px;
      line-height:1.45;
    }

    /* Layout */
    .app-shell{display:flex;min-height:100vh}
    .sidebar{
      width:260px;
      background:linear-gradient(180deg,#ecfeff 0%, #e6fbfb 100%);
      border-right:1px solid rgba(15,23,42,0.04);
      padding:28px 18px;
      display:flex;
      flex-direction:column;
      gap:18px;
    }
    .brand{
      display:flex;align-items:center;gap:12px;padding:6px 6px 14px 6px;
    }
    .brand h1{font-size:18px;color:var(--text);font-weight:700}
    .brand .logo{
      width:36px;height:36px;border-radius:10px;
      background:linear-gradient(135deg,var(--accent),var(--primary));
      display:grid;place-items:center;color:white;font-weight:700;font-size:18px;
      box-shadow:0 6px 18px rgba(2,6,23,0.06);
    }

    .nav{
      display:flex;flex-direction:column;gap:6px;margin-top:8px;
    }
    .nav a{
      display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:10px;
      color: #0f172a;text-decoration:none;font-weight:600;
    }
    .nav a svg{opacity:0.8}
    .nav a:hover{background:rgba(2,6,23,0.03)}
    .nav a.active{background:var(--primary);color:white;box-shadow:0 6px 18px rgba(37,99,235,0.08)}

    .sidebar-footer{margin-top:auto;padding-top:6px;border-top:1px dashed rgba(15,23,42,0.03);color:var(--muted);font-size:13px}

    .main{
      flex:1;display:flex;flex-direction:column;padding:20px 28px;
    }
    .topbar{
      display:flex;align-items:center;justify-content:space-between;padding:12px 8px;margin-bottom:18px;
      gap:12px;
    }
    .search{
      flex:1;max-width:520px;background:white;border-radius:12px;padding:8px 12px;display:flex;gap:8px;align-items:center;
      box-shadow:0 6px 20px rgba(2,6,23,0.04);
    }
    .search input{border:0;outline:0;font-size:14px;width:100%;padding:8px 4px}

    .top-actions{display:flex;gap:10px;align-items:center}
    .top-actions .pill{background:white;padding:8px 12px;border-radius:999px;font-weight:600;box-shadow:0 6px 18px rgba(2,6,23,0.04)}

    .content{
      max-width:var(--container-w);
      width:100%;
      margin:0 auto;
      display:grid;
      grid-template-columns: 1fr 320px;
      gap:18px;
    }

    /* Cards & small panels */
    .card{
      background:white;border-radius:var(--radius);padding:18px;box-shadow:0 6px 20px rgba(2,6,23,0.04);
    }
    .panel{
      background:var(--card);border-radius:12px;padding:18px;
      box-shadow:none;border:1px solid rgba(15,23,42,0.03);
    }

    .row{display:flex;gap:12px;align-items:center}
    .space{flex:1}

    /* big metric */
    .metric{
      font-weight:800;font-size:28px;color:var(--text);
    }
    .muted{color:var(--muted);font-size:13px}
    .kicker{font-size:13px;color:var(--muted);margin-bottom:6px;font-weight:700}
    .small{font-size:13px;color:var(--muted)}

    /* status badge */
    .status-badge{display:inline-block;padding:6px 10px;border-radius:999px;font-weight:700;font-size:13px}
    .status-ok{background:#dcfce7;color:#065f46}
    .status-warn{background:#fff7c2;color:#92400e}
    .status-crit{background:#ffd6d6;color:#9b1c1c}

    /* legend at bottom */
    .legend{display:flex;gap:12px;align-items:center;font-size:13px;color:var(--muted)}
    .dot{width:10px;height:10px;border-radius:50%}

    /* responsive */
    @media (max-width:980px){
      .content{grid-template-columns: 1fr; padding-bottom:30px}
      .sidebar{display:none}
    }
  </style>
</head>
<body>
  <div id="app" class="app-shell">
    <aside class="sidebar" aria-label="Main navigation">
      <div class="brand">
        <div class="logo">CW</div>
        <h1>CrowdWatch</h1>
      </div>

      <nav class="nav" aria-label="Sidebar">
        <a href="{% url 'core_templates:events_list' %}" class="active">
          <!-- simple SVG icon -->
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M3 13h8V3H3v10zM3 21h8v-6H3v6zM13 21h8V11h-8v10zM13 3v6h8V3h-8z" fill="currentColor"/></svg>
          Dashboard
        </a>

        <a href="#" >
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 3v10l3-2 4 4V3" fill="currentColor"/></svg>
          Event Status
        </a>

        <a href="#">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M4 4h16v16H4z" fill="currentColor"/></svg>
          QR Scanner
        </a>

        <a href="#">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M3 6h18" stroke="currentColor" stroke-width="2"/></svg>
          Analytics
        </a>

        <a href="#">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 2v20" stroke="currentColor" stroke-width="2"/></svg>
          Heatmap
        </a>

        <a href="#">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 2l3 7h7l-5.5 4 2 7L12 16l-6.5 4 2-7L2 9h7z" fill="currentColor"/></svg>
          Alerts
        </a>
      </nav>

      <div class="sidebar-footer">
        <div style="font-size:13px;font-weight:700">Logged in as</div>
        <div style="margin-top:6px;color:var(--muted)">Manager • you@example.com</div>
      </div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="search">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="opacity:.55"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          <input placeholder="Search events, IDs, locations…" />
        </div>

        <div class="top-actions">
          {% comment %} <div class="pill">Last updated: <strong style="margin-left:8px">9/15/2024, 8:00 PM</strong></div> {% endcomment %}
          <div class="pill">Notifications <span style="background:#ef4444;color:white;border-radius:999px;padding:3px 7px;margin-left:8px;font-weight:800">3</span></div>
        </div>
      </div>

      <div class="content">
        <!-- main column -->
        <div>
          {% block content %}
          <div class="card" style="display:flex;gap:18px;align-items:flex-start;">
            <div style="flex:1">
              <div class="kicker">Event Details</div>
              <h2 style="margin:6px 0 8px;font-size:20px">Ganesh Festival 2024</h2>
              <div style="display:flex;gap:18px;align-items:center;margin-top:8px">
                <div>
                  <div class="muted">Status</div>
                  <div style="margin-top:6px"><span class="status-badge status-warn">Yellow</span></div>
                </div>

                <div>
                  <div class="muted">Current Count</div>
                  <div class="metric" style="margin-top:6px">8,500</div>
                </div>

                <div>
                  <div class="muted">Capacity</div>
                  <div class="metric" style="margin-top:6px">12,000</div>
                </div>

                <div class="space"></div>

              </div>
            </div>

            <div style="width:260px">
              <div class="panel">
                <div class="kicker">Capacity Usage</div>
                <div style="font-size:22px;font-weight:800;margin-top:8px">70.8%</div>
                <div class="muted" style="margin-top:6px">3500 spots remaining</div>
              </div>

              <div style="height:12px"></div>

              <div class="panel">
                <div class="kicker">Crowd Density</div>
                <div style="font-weight:800;font-size:18px;margin-top:8px">Medium</div>
                <div class="muted" style="margin-top:6px">Based on current thresholds</div>
              </div>
            </div>
          </div>
          {% endblock %}
        </div>

        <!-- right column -->
        <aside style="display:flex;flex-direction:column;gap:18px">
          <div class="card">
            <div class="kicker">Quick Actions</div>
            <div style="display:flex;flex-direction:column;gap:8px;margin-top:10px">
              <button class="btn btn-primary" style="border-radius:10px;padding:10px 12px">Open Scanner</button>
              <button class="btn btn-secondary" style="border-radius:10px;padding:10px 12px">Create Event</button>
            </div>
          </div>

          <div class="card">
            <div class="kicker">Legend</div>
            <div style="display:flex;flex-direction:column;gap:8px;margin-top:8px">
              <div class="legend"><span class="dot" style="background:var(--ok)"></span> Safe (&lt;8,000)</div>
              <div class="legend"><span class="dot" style="background:var(--warn)"></span> Caution (8,000–10,000)</div>
              <div class="legend"><span class="dot" style="background:var(--danger)"></span> Critical (&gt;10,000)</div>
            </div>
          </div>
        </aside>
      </div>

      {% comment %} <div style="max-width:var(--container-w);margin:18px auto 48px">
        <div class="card" style="display:flex;justify-content:space-between;align-items:center">
          <div class="muted">Last updated: 9/15/2024, 8:00 PM</div>
          <div style="display:flex;gap:12px;align-items:center">
            <div style="display:flex;gap:10px;align-items:center">
              <span class="dot" style="background:var(--ok)"></span><span class="muted">Safe (&lt;8,000)</span>
            </div>
            <div style="display:flex;gap:10px;align-items:center">
              <span class="dot" style="background:var(--warn)"></span><span class="muted">Caution (8,000–10,000)</span>
            </div>
            <div style="display:flex;gap:10px;align-items:center">
              <span class="dot" style="background:var(--danger)"></span><span class="muted">Critical (&gt;10,000)</span>
            </div>
          </div>
        </div>
      </div> {% endcomment %}

    </main>
  </div>

  <script>
    // CSRF helper for fetch (Django default cookie name)
    function getCookie(name) {
      let cookieValue = null;
      if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
          const cookie = cookies[i].trim();
          if (cookie.substring(0, name.length + 1) === (name + '=')) {
            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
            break;
          }
        }
      }
      return cookieValue;
    }
    const CSRF_TOKEN = getCookie('csrftoken');

    async function apiFetch(url, opts = {}) {
      opts.headers = opts.headers || {};
      if (!opts.method || opts.method.toUpperCase() === 'GET') {
        // no csrf required
      } else {
        opts.headers['X-CSRFToken'] = CSRF_TOKEN;
        opts.headers['Content-Type'] = opts.headers['Content-Type'] || 'application/json';
      }
      const res = await fetch(url, opts);
      if (!res.ok) {
        const text = await res.text();
        throw new Error(`${res.status} ${res.statusText}: ${text}`);
      }
      return res.json().catch(() => null);
    }
  </script>

  {% block scripts %}{% endblock %}
</body>
</html>

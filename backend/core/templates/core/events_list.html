{% extends "core/base.html" %}
{% block title %}Events ‚Äî CrowdMgmt Test UI{% endblock %}

{% block content %}
  <section>
    <h2 style="margin-bottom: 1rem;">Events</h2>
    <div id="events-container" class="events-grid">Loading events‚Ä¶</div>
  </section>
{% endblock %}

{% block scripts %}
<script>
  async function loadEvents() {
    const listEl = document.getElementById('events-container');
    try {
      const events = await apiFetch('/api/events/');
      if (!events || events.length === 0) {
        listEl.innerHTML = '<p>No events returned.</p>';
        return;
      }

      // Clear container and use grid layout
      listEl.innerHTML = '';
      events.forEach(ev => {
        const card = document.createElement('div');
        card.className = 'card event-card';

        const title = document.createElement('h3');
        title.textContent = ev.name || `Event #${ev.id}`;

        const location = document.createElement('p');
        location.textContent = ev.location ? `üìç ${ev.location}` : 'Location not specified';

        const link = document.createElement('a');
        link.href = `/test/events/${ev.id}/`;
        link.textContent = 'View Details';
        link.className = 'btn btn-primary';

        card.appendChild(title);
        card.appendChild(location);
        card.appendChild(link);

        listEl.appendChild(card);
      });
    } catch (err) {
      listEl.innerHTML = `<pre style="color:red">${err.message}</pre>`;
    }
  }

  document.addEventListener('DOMContentLoaded', loadEvents);
</script>

<style>
  /* Events grid */
  .events-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 1.5rem;
  }

  .event-card h3 {
    margin-bottom: 0.5rem;
    font-size: 1.2rem;
    color: #1e293b;
  }

  .event-card p {
    margin-bottom: 1rem;
    color: #475569;
    font-size: 0.95rem;
  }
</style>
{% endblock %}
